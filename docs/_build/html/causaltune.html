<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>causaltune package &#8212; CausalTune 2022 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/readable.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CausalTune 2022 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">causaltune package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="causaltune-package">
<h1>causaltune package<a class="headerlink" href="#causaltune-package" title="Permalink to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="causaltune.models.html">causaltune.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#module-causaltune.models.dummy">causaltune.models.dummy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.Dummy"><code class="docutils literal notranslate"><span class="pre">Dummy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.Dummy.effect"><code class="docutils literal notranslate"><span class="pre">Dummy.effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.Dummy.identifier_method"><code class="docutils literal notranslate"><span class="pre">Dummy.identifier_method</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.DummyModel"><code class="docutils literal notranslate"><span class="pre">DummyModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.DummyModel.fit"><code class="docutils literal notranslate"><span class="pre">DummyModel.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.DummyModel.predict"><code class="docutils literal notranslate"><span class="pre">DummyModel.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.MultivaluePSW"><code class="docutils literal notranslate"><span class="pre">MultivaluePSW</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.NaiveDummy"><code class="docutils literal notranslate"><span class="pre">NaiveDummy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.PropensityScoreWeighter"><code class="docutils literal notranslate"><span class="pre">PropensityScoreWeighter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.PropensityScoreWeighter.fit"><code class="docutils literal notranslate"><span class="pre">PropensityScoreWeighter.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.PropensityScoreWeighter.predict"><code class="docutils literal notranslate"><span class="pre">PropensityScoreWeighter.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.SimpleIV"><code class="docutils literal notranslate"><span class="pre">SimpleIV</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.SimpleIV.effect"><code class="docutils literal notranslate"><span class="pre">SimpleIV.effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.SimpleIV.identifier_method"><code class="docutils literal notranslate"><span class="pre">SimpleIV.identifier_method</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.dummy.weighted_average"><code class="docutils literal notranslate"><span class="pre">weighted_average()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#module-causaltune.models.monkey_patches">causaltune.models.monkey_patches module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.monkey_patches.AutoML"><code class="docutils literal notranslate"><span class="pre">AutoML</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.monkey_patches.AutoML.fit"><code class="docutils literal notranslate"><span class="pre">AutoML.fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.monkey_patches.apply_multitreatment"><code class="docutils literal notranslate"><span class="pre">apply_multitreatment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.monkey_patches.effect"><code class="docutils literal notranslate"><span class="pre">effect()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.monkey_patches.effect_stderr"><code class="docutils literal notranslate"><span class="pre">effect_stderr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.monkey_patches.effect_tt"><code class="docutils literal notranslate"><span class="pre">effect_tt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#module-causaltune.models.passthrough">causaltune.models.passthrough module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.passthrough.PassthroughInner"><code class="docutils literal notranslate"><span class="pre">PassthroughInner</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.passthrough.PassthroughInner.fit"><code class="docutils literal notranslate"><span class="pre">PassthroughInner.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.passthrough.PassthroughInner.predict_proba"><code class="docutils literal notranslate"><span class="pre">PassthroughInner.predict_proba()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.passthrough.PassthroughInner.score"><code class="docutils literal notranslate"><span class="pre">PassthroughInner.score()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.passthrough.feature_filter"><code class="docutils literal notranslate"><span class="pre">feature_filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.passthrough.passthrough_model"><code class="docutils literal notranslate"><span class="pre">passthrough_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#module-causaltune.models.transformed_outcome">causaltune.models.transformed_outcome module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.transformed_outcome.TransformedOutcome"><code class="docutils literal notranslate"><span class="pre">TransformedOutcome</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.transformed_outcome.TransformedOutcomeFitter"><code class="docutils literal notranslate"><span class="pre">TransformedOutcomeFitter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.transformed_outcome.TransformedOutcomeFitter.fit"><code class="docutils literal notranslate"><span class="pre">TransformedOutcomeFitter.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.transformed_outcome.TransformedOutcomeFitter.predict"><code class="docutils literal notranslate"><span class="pre">TransformedOutcomeFitter.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.transformed_outcome.TransformedOutcomeFitter.shap_values"><code class="docutils literal notranslate"><span class="pre">TransformedOutcomeFitter.shap_values()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.transformed_outcome.transformed_outcome"><code class="docutils literal notranslate"><span class="pre">transformed_outcome()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#module-causaltune.models.wrapper">causaltune.models.wrapper module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyMethods"><code class="docutils literal notranslate"><span class="pre">DoWhyMethods</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyMethods.const_marginal_effect"><code class="docutils literal notranslate"><span class="pre">DoWhyMethods.const_marginal_effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyMethods.effect"><code class="docutils literal notranslate"><span class="pre">DoWhyMethods.effect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyWrapper"><code class="docutils literal notranslate"><span class="pre">DoWhyWrapper</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyWrapper.const_marginal_effect"><code class="docutils literal notranslate"><span class="pre">DoWhyWrapper.const_marginal_effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyWrapper.effect"><code class="docutils literal notranslate"><span class="pre">DoWhyWrapper.effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyWrapper.estimate_effect"><code class="docutils literal notranslate"><span class="pre">DoWhyWrapper.estimate_effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyWrapper.fit"><code class="docutils literal notranslate"><span class="pre">DoWhyWrapper.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.DoWhyWrapper.shap_values"><code class="docutils literal notranslate"><span class="pre">DoWhyWrapper.shap_values()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="causaltune.models.html#causaltune.models.wrapper.remove_list"><code class="docutils literal notranslate"><span class="pre">remove_list()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="causaltune.models.html#module-causaltune.models">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-causaltune.data_utils">
<span id="causaltune-data-utils-module"></span><h2>causaltune.data_utils module<a class="headerlink" href="#module-causaltune.data_utils" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">CausalityDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_causes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/data_utils.html#CausalityDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.CausalityDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.common_causes">
<span class="sig-name descname"><span class="pre">common_causes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.common_causes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataFrame</span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.effect_modifiers">
<span class="sig-name descname"><span class="pre">effect_modifiers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.effect_modifiers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.instruments">
<span class="sig-name descname"><span class="pre">instruments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.instruments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.outcomes">
<span class="sig-name descname"><span class="pre">outcomes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.outcomes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.preprocess_dataset">
<span class="sig-name descname"><span class="pre">preprocess_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_floats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_min_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/data_utils.html#CausalityDataset.preprocess_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.preprocess_dataset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Preprocesses input dataset for CausalTune by</dt><dd><p>converting treatment and instrument columns to integer, normalizing, filling nans, and one-hot encoding.</p>
</dd>
</dl>
<p>&#64;param drop_first (bool): whether to drop the first dummy variable for each categorical feature (default False)
&#64;param scale_floats (bool): whether to scale float features to have zero mean and unit variance (default False)
&#64;param prune_min_categories (int): min number of categories to keep for each categorical feature (default 50)
&#64;param prune_thresh (float): threshold for category frequency when pruning categories (default 0.99)</p>
<p>&#64;return: None. Modifies self.data in-place by replacing it with the preprocessed dataframe.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.propensity_modifiers">
<span class="sig-name descname"><span class="pre">propensity_modifiers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.propensity_modifiers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.treatment">
<span class="sig-name descname"><span class="pre">treatment</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.treatment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.treatment_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">treatment_values</span></span><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.treatment_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.data_utils.featurize">
<span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">featurize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_floats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_min_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/causaltune/data_utils.html#featurize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.featurize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.data_utils.frequent_values">
<span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">frequent_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span></span></span><a class="reference internal" href="_modules/causaltune/data_utils.html#frequent_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.frequent_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.data_utils.otherize_tail">
<span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">otherize_tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/causaltune/data_utils.html#otherize_tail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.otherize_tail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-causaltune.datasets">
<span id="causaltune-datasets-module"></span><h2>causaltune.datasets module<a class="headerlink" href="#module-causaltune.datasets" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.amazon_reviews">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">amazon_reviews</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pos'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#amazon_reviews"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.amazon_reviews" title="Permalink to this definition">¶</a></dt>
<dd><p>loads amazon reviews dataset
The dataset describes the impact of positive (or negative) reviews for products on Amazon on sales.
The authors distinguish between items with more than three reviews (treated) and less than three
reviews (untreated). As the rating given by reviews might impact sales, they divide the dataset
into products with on average positive (more than 3 starts) or negative (less than three stars)
reviews.
The dataset consists of 305 covariates (doc2vec features of the review text), a binary treatment
variable (more than 3 reviews vs less than three reviews) and a continuous outcome (sales).</p>
<p>If used for academic purposes, please consider citing the authors:
&#64;inproceedings{rakesh2018linked,</p>
<blockquote>
<div><p>title={Linked Causal Variational Autoencoder for Inferring Paired Spillover Effects},
author={Rakesh, Vineeth and Guo, Ruocheng and Moraffah, Raha and Agarwal, Nitin and Liu, Huan},
booktitle={Proceedings of the 27th ACM International Conference on Information and Knowledge Management},
pages={1679–1682},
year={2018},
organization={ACM}</p>
</div></blockquote>
<p>}
:param rating: choose between positive (‘pos’) and negative (‘neg’) reviews. Defaults to ‘pos’.
:type rating: str, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataset with cols “treatment”, “y_factual” and covariates “x1” to “x300”</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.generate_non_random_dataset">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_non_random_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/datasets.html#generate_non_random_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.generate_non_random_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthetic dataset with non-uniform propensities to treat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of independent samples. Defaults to 1000.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data object for causal inference</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.generate_synth_data_with_categories">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_synth_data_with_categories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_effect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#generate_synth_data_with_categories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.generate_synth_data_with_categories" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Generates synthetic dataset just with categorical features</dt><dd><p>Can be used, e.g. in connection with Wise pizza segmentation analysis</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of independent samples. Defaults to 10000.</p></li>
<li><p><strong>n_x</strong> (<em>int</em><em>, </em><em>optional</em>) – number of features. Must be at least 3. Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.generate_synthetic_data">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'isotropic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confounding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_confounder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisy_outcomes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_instrument</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#generate_synthetic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.generate_synthetic_data" title="Permalink to this definition">¶</a></dt>
<dd><p>generates synthetic dataset with conditional treatment effect (CATE) and optional instrumental variable.
Supports RCT (unconfounded) and observational (confounded) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of independent samples. Defaults to 100.</p></li>
<li><p><strong>n_covariates</strong> (<em>int</em><em>, </em><em>optional</em>) – number of covariates. Defaults to 5.</p></li>
<li><p><strong>covariance</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – covariance matrix of covariates. can be “isotropic”,
“anisotropic” or user-supplied. Defaults to “isotropic”.</p></li>
<li><p><strong>confounding</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether or not values of covariates affect treatment effect. Defaults to True.</p></li>
<li><p><strong>noisy_outcomes</strong> (<em>bool</em><em>, </em><em>optional</em>) – additive noise in the outcomes. Defaults to False.</p></li>
<li><p><strong>add_instrument</strong> (<em>bool</em><em>, </em><em>optional</em>) – include instrumental variable (yes/no). Defaults to False</p></li>
<li><p><strong>effect_size</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>None</em><em>]</em>) – if provided, constant effect size (ATE). if None, generate CATE.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>columns for covariates, treatment assignment, outcome and true treatment effect</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.iv_dgp_econml">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">iv_dgp_econml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_effect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/datasets.html#iv_dgp_econml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.iv_dgp_econml" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates synthetic IV data for binary treatment and instruments.
Source: <a class="reference external" href="https://github.com/microsoft/EconML/tree/main/notebooks/">https://github.com/microsoft/EconML/tree/main/notebooks/</a>
Eg: OrthoIV and DRIV Examples.ipynb</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – number of data instances</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of observed features</p></li>
<li><p><strong>true_effect</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>, </em><em>Callable</em><em>]</em>) – known effect (function or value) to observe.
Can be a function of covariates or a constant</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Data class containing (1) pd.DataFrame with columns “treatment”, “y”</dt><dd><p>and covariates from “x_0” to “x_{p}”, and labels for treatment,
outcome and instrument variables and</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.lalonde_nsw">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">lalonde_nsw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#lalonde_nsw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.lalonde_nsw" title="Permalink to this definition">¶</a></dt>
<dd><p>loads the Lalonde NSW dataset
The dataset described the impact of a job training programme on the real earnings
of individuals several years later.
The data consists of the treatment indicator (training yes no), covariates (age, race,
academic background, real earnings 1976, real earnings 1977) and the outcome (real earnings in 1978)
See also <a class="reference external" href="https://rdrr.io/cran/qte/man/lalonde.html#heading-0">https://rdrr.io/cran/qte/man/lalonde.html#heading-0</a></p>
<p>If used for academic purposes, please consider citing the authors:
Lalonde, Robert: “Evaluating the Econometric Evaluations of Training Programs,” American Economic Review,
Vol. 76, pp. 604-620</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataset with cols “treatment”, “y_factual” and covariates “x1” to “x8”</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.linear_multi_dataset">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">linear_multi_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_propensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_control</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#linear_multi_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.linear_multi_dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.mlrate_experiment_synth_dgp">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">mlrate_experiment_synth_dgp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_te</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/datasets.html#mlrate_experiment_synth_dgp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.mlrate_experiment_synth_dgp" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthetic DGP taken from
Guo, Yongyi, et al. “Machine learning for variance reduction in online experiments.”
Advances in Neural Information Processing Systems 34 (2021): 8637-8648.
<a class="reference external" href="https://proceedings.neurips.cc/paper/2021/file/488b084119a1c7a4950f00706ec7ea16-Paper.pdf">https://proceedings.neurips.cc/paper/2021/file/488b084119a1c7a4950f00706ec7ea16-Paper.pdf</a></p>
<p>DGP:</p>
<p>Y_i = b(X_i) + T_i*(const_te+tau(X_i)) + noise*u_i
with
b(X_i) = 10*sin(pi*X_{i0}X_{i1}) + 20*(X_{i2}-.5)^2 + 10*X_{i3} + 5*X_{i4}</p>
<p>and</p>
<p>tau(X_i) = cate_scaler*(X_{i1} + log(1+exp(X_{i2})) - 0.805850803366056),
T_i ~ Bernoulli(.5), u_i ~ Normal(0,25^2)</p>
<p>The DGP is set up in a way that there ATE = const_te.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – sample size. Defaults to 10000.</p></li>
<li><p><strong>n_x</strong> (<em>int</em><em>, </em><em>optional</em>) – number of covariates. At least 4. Defaults to 100.</p></li>
<li><p><strong>const_te</strong> (<em>float</em><em>, </em><em>optional</em>) – constant average treatment effect</p></li>
<li><p><strong>noise</strong> (<em>float</em><em>, </em><em>optional</em>) – exogeneous variance scaler</p></li>
<li><p><strong>cate_scaler</strong> (<em>float</em><em>, </em><em>optional</em>) – heterogeneous treatment effect scaler</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data object for causal inference</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>cd (<a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.nhefs">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">nhefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#nhefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.nhefs" title="Permalink to this definition">¶</a></dt>
<dd><p>loads the NHEFS dataset
The dataset describes the impact of quitting smoke on weight gain over a period of 11 years
The data consists of the treatment (quit smoking yes no), the outcome (change in weight) and
a series of covariates of which we include a subset of 9 (see below).</p>
<p>If used for academic purposes, pelase consider citing the authors:
Hernán MA, Robins JM (2020). Causal Inference: What If. Boca Raton: Chapman &amp; Hall/CRC.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataset with cols “treatment”, “y_factual” and covariates “x1” to “x9”</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.synth_acic">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">synth_acic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#synth_acic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.synth_acic" title="Permalink to this definition">¶</a></dt>
<dd><p>loads data from ACIC Causal Inference Challenge 2016
The dataset consists of 58 covariates, a binary treatment and a continuous response.
There are 10 simulated pairs of treatment and response, which can be selected
with the condition argument supplied to this function.</p>
<p>If used for academic purposes, consider citing the authors:
&#64;article{dorie2019automated,</p>
<blockquote>
<div><dl class="simple">
<dt>title={Automated versus do-it-yourself methods for causal inference: Lessons learned from a</dt><dd><p>data analysis competition},</p>
</dd>
</dl>
<p>author={Dorie, Vincent and Hill, Jennifer and Shalit, Uri and Scott, Marc and Cervone, Dan},
journal={Statistical Science},
volume={34},
number={1},
pages={43–68},
year={2019},
publisher={Institute of Mathematical Statistics}</p>
</div></blockquote>
<p>}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>condition</strong> (<em>int</em>) – in [1,10], corresponds to 10 simulated treatment/response pairs. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataset for causal inference with columns “treatment”, “y_factual” and covariates “x_1” to “x_58”</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.synth_ihdp">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">synth_ihdp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#synth_ihdp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.synth_ihdp" title="Permalink to this definition">¶</a></dt>
<dd><p>loads IHDP dataset
The Infant Health and Development Program (IHDP) dataset contains data on the impact of visits by specialists
on the cognitive development of children. The dataset consists of 25 covariates describing various features
of these children and their mothers, a binary treatment variable (visit/no visit) and a continuous outcome.</p>
<p>If used for academic purposes, consider citing the authors:
&#64;article{hill2011,</p>
<blockquote>
<div><p>title={Bayesian nonparametric modeling for causal inference.},
author={Hill, Jennifer},
journal={Journal of Computational and Graphical Statistics},
volume={20},
number={1},
pages={217–240},
year={2011}</p>
</div></blockquote>
<p>}</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dataset for causal inference with cols “treatment”, “y_factual” and covariates “x1” to “x25”</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-causaltune.erupt">
<span id="causaltune-erupt-module"></span><h2>causaltune.erupt module<a class="headerlink" href="#module-causaltune.erupt" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.erupt.DummyPropensity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.erupt.</span></span><span class="sig-name descname"><span class="pre">DummyPropensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/erupt.html#DummyPropensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.DummyPropensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.erupt.DummyPropensity.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/erupt.html#DummyPropensity.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.DummyPropensity.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.erupt.DummyPropensity.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/erupt.html#DummyPropensity.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.DummyPropensity.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="causaltune.erupt.ERUPT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.erupt.</span></span><span class="sig-name descname"><span class="pre">ERUPT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treatment_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">typing.Optional[typing.List[str]]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_tiny</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/erupt.html#ERUPT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.ERUPT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.erupt.ERUPT.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/erupt.html#ERUPT.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.ERUPT.fit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.erupt.ERUPT.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/causaltune/erupt.html#ERUPT.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.ERUPT.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.erupt.ERUPT.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Series</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/causaltune/erupt.html#ERUPT.weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.erupt.ERUPT.weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-causaltune.memoizer">
<span id="causaltune-memoizer-module"></span><h2>causaltune.memoizer module<a class="headerlink" href="#module-causaltune.memoizer" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.memoizer.Memoizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.memoizer.</span></span><span class="sig-name descname"><span class="pre">Memoizer</span></span><a class="reference internal" href="_modules/causaltune/memoizer.html#Memoizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.Memoizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="causaltune.memoizer.MemoizingWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.memoizer.</span></span><span class="sig-name descname"><span class="pre">MemoizingWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/memoizer.html#MemoizingWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.MemoizingWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AutoML</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.memoizer.MemoizingWrapper.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/memoizer.html#MemoizingWrapper.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.MemoizingWrapper.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a model for a given task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> – A numpy array or a pandas dataframe of training data in
shape (n, m). For time series forecsat tasks, the first column of X_train
must be the timestamp column (datetime type). Other columns in
the dataframe are assumed to be exogenous variables (categorical or numeric).
When using ray, X_train can be a ray.ObjectRef.</p></li>
<li><p><strong>y_train</strong> – A numpy array or a pandas series of labels in shape (n, ).</p></li>
<li><p><strong>dataframe</strong> – A dataframe of training data including label column.
For time series forecast tasks, dataframe must be specified and must have
at least two columns, timestamp and label, where the first
column is the timestamp column (datetime type). Other columns in
the dataframe are assumed to be exogenous variables (categorical or numeric).
When using ray, dataframe can be a ray.ObjectRef.</p></li>
<li><p><strong>label</strong> – A str of the label column name for, e.g., ‘label’;
Note: If X_train and y_train are provided,
dataframe and label are ignored;
If not, dataframe and label must be provided.</p></li>
<li><p><strong>metric</strong> – A string of the metric name or a function,
e.g., ‘accuracy’, ‘roc_auc’, ‘roc_auc_ovr’, ‘roc_auc_ovo’,
‘f1’, ‘micro_f1’, ‘macro_f1’, ‘log_loss’, ‘mae’, ‘mse’, ‘r2’,
‘mape’. Default is ‘auto’.
If passing a customized metric function, the function needs to
have the following input arguments:</p></li>
</ul>
</dd>
</dl>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
def custom_metric(</p>
<blockquote>
<div><p>X_test, y_test, estimator, labels,
X_train, y_train, weight_test=None, weight_train=None,
config=None, groups_test=None, groups_train=None,</p>
</div></blockquote>
<dl class="simple">
<dt>):</dt><dd><p>return metric_to_minimize, metrics_to_log</p>
</dd>
</dl>
<dl class="simple">
<dt><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></dt><dd><p>which returns a float number as the minimization objective,
and a dictionary as the metrics to log. E.g.,</p>
</dd>
</dl>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
def custom_metric(</p>
<blockquote>
<div><p>X_val, y_val, estimator, labels,
X_train, y_train, weight_val=None, weight_train=None,
<a href="#id13"><span class="problematic" id="id14">*</span></a>args,</p>
</div></blockquote>
<dl>
<dt>):</dt><dd><p>from sklearn.metrics import log_loss
import time</p>
<p>start = time.time()
y_pred = estimator.predict_proba(X_val)
pred_time = (time.time() - start) / len(X_val)
val_loss = log_loss(y_val, y_pred, labels=labels, sample_weight=weight_val)
y_pred = estimator.predict_proba(X_train)
train_loss = log_loss(y_train, y_pred, labels=labels, sample_weight=weight_train)
alpha = 0.5
return val_loss * (1 + alpha) - alpha * train_loss, {</p>
<blockquote>
<div><p>“val_loss”: val_loss,
“train_loss”: train_loss,
“pred_time”: pred_time,</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<dl>
<dt><a href="#id15"><span class="problematic" id="id16">``</span></a><a href="#id17"><span class="problematic" id="id18">`</span></a></dt><dd><dl class="simple">
<dt>task: A string of the task type, e.g.,</dt><dd><p>‘classification’, ‘regression’, ‘ts_forecast_regression’,
‘ts_forecast_classification’, ‘ts_forecast_panel’, ‘rank’, ‘seq-classification’,
‘seq-regression’, ‘summarization’.</p>
</dd>
<dt>n_jobs: An integer of the number of threads for training | default=-1.</dt><dd><p>Use all available resources when n_jobs == -1.</p>
</dd>
<dt>log_file_name: A string of the log file name | default=””. To disable logging,</dt><dd><p>set it to be an empty string “”.</p>
</dd>
<dt>estimator_list: A list of strings for estimator names, or ‘auto’.</dt><dd><p>e.g., <code class="docutils literal notranslate"><span class="pre">`['lgbm',</span> <span class="pre">'xgboost',</span> <span class="pre">'xgb_limitdepth',</span> <span class="pre">'catboost',</span> <span class="pre">'rf',</span> <span class="pre">'extra_tree']`</span></code>.</p>
</dd>
<dt>time_budget: A float number of the time budget in seconds.</dt><dd><p>Use -1 if no time limit.</p>
</dd>
<dt>max_iter: An integer of the maximal number of iterations.</dt><dd><p>NOTE: when both time_budget and max_iter are unspecified,
only one model will be trained per estimator.</p>
</dd>
<dt>sample: A boolean of whether to sample the training data during</dt><dd><p>search.</p>
</dd>
<dt>ensemble: boolean or dict | default=False. Whether to perform</dt><dd><p>ensemble after search. Can be a dict with keys ‘passthrough’
and ‘final_estimator’ to specify the passthrough and
final_estimator in the stacker. The dict can also contain
‘n_jobs’ as the key to specify the number of jobs for the stacker.</p>
</dd>
<dt>eval_method: A string of resampling strategy, one of</dt><dd><p>[‘auto’, ‘cv’, ‘holdout’].</p>
</dd>
</dl>
<p>split_ratio: A float of the valiation data percentage for holdout.
n_splits: An integer of the number of folds for cross - validation.
log_type: A string of the log type, one of</p>
<blockquote>
<div><p>[‘better’, ‘all’].
‘better’ only logs configs with better loss than previos iters
‘all’ logs all the tried configs.</p>
</div></blockquote>
<dl class="simple">
<dt>model_history: A boolean of whether to keep the trained best</dt><dd><p>model per estimator. Make sure memory is large enough if setting to True.
Default value is False: best_model_for_estimator would return a
untrained model for non-best learner.</p>
</dd>
<dt>log_training_metric: A boolean of whether to log the training</dt><dd><p>metric for each model.</p>
</dd>
</dl>
<p>mem_thres: A float of the memory size constraint in bytes.
pred_time_limit: A float of the prediction latency constraint in seconds.</p>
<blockquote>
<div><p>It refers to the average prediction time per row in validation data.</p>
</div></blockquote>
<p>train_time_limit: A float of the training time constraint in seconds.
X_val: None or a numpy array or a pandas dataframe of validation data.
y_val: None or a numpy array or a pandas series of validation labels.
sample_weight_val: None or a numpy array of the sample weight of</p>
<blockquote>
<div><p>validation data of the same shape as y_val.</p>
</div></blockquote>
<dl>
<dt>groups_val: None or array-like | group labels (with matching length</dt><dd><p>to y_val) or group counts (with sum equal to length of y_val)
for validation data. Need to be consistent with groups.</p>
</dd>
<dt>groups: None or array-like | Group labels (with matching length to</dt><dd><p>y_train) or groups counts (with sum equal to length of y_train)
for training data.</p>
</dd>
<dt>verbose: int, default=3 | Controls the verbosity, higher means more</dt><dd><p>messages.</p>
</dd>
<dt>retrain_full: bool or str, default=True | whether to retrain the</dt><dd><p>selected model on the full training data when using holdout.
True - retrain only after search finishes; False - no retraining;
‘budget’ - do best effort to retrain without violating the time
budget.</p>
</dd>
<dt>split_type: str or splitter object, default=”auto” | the data split type.</dt><dd><ul class="simple">
<li><p>A valid splitter object is an instance of a derived class of scikit-learn</p></li>
</ul>
<p>[KFold](<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold</a>)
and have <code class="docutils literal notranslate"><span class="pre">split</span></code> and <code class="docutils literal notranslate"><span class="pre">get_n_splits</span></code> methods with the same signatures.
Set eval_method to “cv” to use the splitter object.
* Valid str options depend on different tasks.
For classification tasks, valid choices are</p>
<blockquote>
<div><p>[“auto”, ‘stratified’, ‘uniform’, ‘time’, ‘group’]. “auto” -&gt; stratified.</p>
</div></blockquote>
<dl class="simple">
<dt>For regression tasks, valid choices are [“auto”, ‘uniform’, ‘time’].</dt><dd><p>“auto” -&gt; uniform.</p>
</dd>
</dl>
<p>For time series forecast tasks, must be “auto” or ‘time’.
For ranking task, must be “auto” or ‘group’.</p>
</dd>
<dt>hpo_method: str, default=”auto” | The hyperparameter</dt><dd><p>optimization method. By default, CFO is used for sequential
search and BlendSearch is used for parallel search.
No need to set when using flaml’s default search space or using
a simple customized search space. When set to ‘bs’, BlendSearch
is used. BlendSearch can be tried when the search space is
complex, for example, containing multiple disjoint, discontinuous
subspaces. When set to ‘random’, random search is used.</p>
</dd>
<dt>starting_points: A dictionary or a str to specify the starting hyperparameter</dt><dd><p>config for the estimators | default=”data”.
If str:</p>
<blockquote>
<div><ul class="simple">
<li><p>if “data”, use data-dependent defaults;</p></li>
<li><p>if “<a class="reference external" href="data:path">data:path</a>” use data-dependent defaults which are stored at path;</p></li>
<li><p>if “static”, use data-independent defaults.</p></li>
</ul>
</div></blockquote>
<p>If dict, keys are the name of the estimators, and values are the starting
hyperparamter configurations for the corresponding estimators.
The value can be a single hyperparamter configuration dict or a list
of hyperparamter configuration dicts.
In the following code example, we get starting_points from the
<cite>automl</cite> object and use them in the <cite>new_automl</cite> object.
e.g.,</p>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id21"><span class="problematic" id="id22">`</span></a>python
from flaml import AutoML
automl = AutoML()
X_train, y_train = load_iris(return_X_y=True)
automl.fit(X_train, y_train)
starting_points = automl.best_config_per_estimator</p>
<p>new_automl = AutoML()
new_automl.fit(X_train, y_train, starting_points=starting_points)
<a href="#id23"><span class="problematic" id="id24">``</span></a><a href="#id25"><span class="problematic" id="id26">`</span></a></p>
<blockquote>
<div><p>seed: int or None, default=None | The random seed for hpo.
n_concurrent_trials: [Experimental] int, default=1 | The number of</p>
<blockquote>
<div><p>concurrent trials. When n_concurrent_trials &gt; 1, flaml performes
[parallel tuning](../Use-Cases/Task-Oriented-AutoML#parallel-tuning)
and installation of ray is required: <cite>pip install flaml[ray]</cite>.</p>
</div></blockquote>
<dl class="simple">
<dt>keep_search_state: boolean, default=False | Whether to keep data needed</dt><dd><p>for model search after fit(). By default the state is deleted for
space saving.</p>
</dd>
<dt>preserve_checkpoint: boolean, default=True | Whether to preserve the saved checkpoint</dt><dd><p>on disk when deleting automl. By default the checkpoint is preserved.</p>
</dd>
<dt>early_stop: boolean, default=False | Whether to stop early if the</dt><dd><p>search is considered to converge.</p>
</dd>
<dt>append_log: boolean, default=False | Whetehr to directly append the log</dt><dd><p>records to the input log file if it exists.</p>
</dd>
<dt>auto_augment: boolean, default=True | Whether to automatically</dt><dd><p>augment rare classes.</p>
</dd>
<dt>min_sample_size: int, default=MIN_SAMPLE_TRAIN | the minimal sample</dt><dd><p>size when sample=True.</p>
</dd>
<dt>use_ray: boolean or dict.</dt><dd><p>If boolean: default=False | Whether to use ray to run the training
in separate processes. This can be used to prevent OOM for large
datasets, but will incur more overhead in time.
If dict: the dict contains the keywords arguments to be passed to
[ray.tune.run](<a class="reference external" href="https://docs.ray.io/en/latest/tune/api_docs/execution.html">https://docs.ray.io/en/latest/tune/api_docs/execution.html</a>).</p>
</dd>
<dt>metric_constraints: list, default=[] | The list of metric constraints.</dt><dd><p>Each element in this list is a 3-tuple, which shall be expressed
in the following format: the first element of the 3-tuple is the name of the
metric, the second element is the inequality sign chosen from “&gt;=” and “&lt;=”,
and the third element is the constraint value. E.g., <cite>(‘precision’, ‘&gt;=’, 0.9)</cite>.
Note that all the metric names in metric_constraints need to be reported via
the metrics_to_log dictionary returned by a customized metric function.
The customized metric function shall be provided via the <cite>metric</cite> key word argument
of the fit() function or the automl constructor.
Find examples in this [test](<a class="reference external" href="https://github.com/microsoft/FLAML/tree/main/test/automl/test_constraints.py">https://github.com/microsoft/FLAML/tree/main/test/automl/test_constraints.py</a>).
If <cite>pred_time_limit</cite> is provided as one of keyword arguments to fit() function or
the automl constructor, flaml will automatically (and under the hood)
add it as an additional element in the metric_constraints. Essentially ‘pred_time_limit’
specifies a constraint about the prediction latency constraint in seconds.</p>
</dd>
<dt>custom_hp: dict, default=None | The custom search space specified by user</dt><dd><p>Each key is the estimator name, each value is a dict of the custom search space for that estimator. Notice the
domain of the custom search space can either be a value of a sample.Domain object.</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id27"><span class="problematic" id="id28">``</span></a><a href="#id29"><span class="problematic" id="id30">`</span></a>python
custom_hp = {</p>
<blockquote>
<div><dl>
<dt>“transformer_ms”: {</dt><dd><dl class="simple">
<dt>“model_path”: {</dt><dd><p>“domain”: “albert-base-v2”,</p>
</dd>
</dl>
<p>},
“learning_rate”: {</p>
<blockquote>
<div><p>“domain”: tune.choice([1e-4, 1e-5]),</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<section id="id31">
<h3>}<a class="headerlink" href="#id31" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl>
<dt>cv_score_agg_func: customized cross-validation scores aggregate function. Default to average metrics across folds. If specificed, this function needs to</dt><dd><p>have the following input arguments:</p>
<ul class="simple">
<li><p>val_loss_folds: list of floats, the loss scores of each fold;</p></li>
<li><p>log_metrics_folds: list of dicts/floats, the metrics of each fold to log.</p></li>
</ul>
<dl class="simple">
<dt>This function should return the final aggregate result of all folds. A float number of the minimization objective, and a dictionary as the metrics to log or None.</dt><dd><p>E.g.,</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p><a href="#id32"><span class="problematic" id="id33">``</span></a><a href="#id34"><span class="problematic" id="id35">`</span></a>python
def cv_score_agg_func(val_loss_folds, log_metrics_folds):</p>
<blockquote>
<div><p>metric_to_minimize = sum(val_loss_folds)/len(val_loss_folds)
metrics_to_log = None
for single_fold in log_metrics_folds:</p>
<blockquote>
<div><dl class="simple">
<dt>if metrics_to_log is None:</dt><dd><p>metrics_to_log = single_fold</p>
</dd>
<dt>elif isinstance(metrics_to_log, dict):</dt><dd><p>metrics_to_log = {k: metrics_to_log[k] + v for k, v in single_fold.items()}</p>
</dd>
<dt>else:</dt><dd><p>metrics_to_log += single_fold</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>if metrics_to_log:</dt><dd><p>n = len(val_loss_folds)
metrics_to_log = (</p>
<blockquote>
<div><p>{k: v / n for k, v in metrics_to_log.items()}
if isinstance(metrics_to_log, dict)
else metrics_to_log / n</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
<p>return metric_to_minimize, metrics_to_log</p>
</div></blockquote>
<p><a href="#id36"><span class="problematic" id="id37">``</span></a><a href="#id38"><span class="problematic" id="id39">`</span></a></p>
<blockquote>
<div><p>skip_transform: boolean, default=False | Whether to pre-process data prior to modeling.
fit_kwargs_by_estimator: dict, default=None | The user specified keywords arguments, grouped by estimator name.</p>
<blockquote>
<div><p>For TransformersEstimator, available fit_kwargs can be found from
[TrainingArgumentsForAuto](nlp/huggingface/training_args).
e.g.,</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id40"><span class="problematic" id="id41">``</span></a><a href="#id42"><span class="problematic" id="id43">`</span></a>python
fit_kwargs_by_estimator = {</p>
<blockquote>
<div><dl class="simple">
<dt>“transformer”: {</dt><dd><p>“output_dir”: “test/data/output/”,
“fp16”: False,</p>
</dd>
</dl>
<p>},
“tft”: {</p>
<blockquote>
<div><p>“max_encoder_length”: 1,
“min_encoder_length”: 1,
“static_categoricals”: [],
“static_reals”: [],
“time_varying_known_categoricals”: [],
“time_varying_known_reals”: [],
“time_varying_unknown_categoricals”: [],
“time_varying_unknown_reals”: [],
“variable_groups”: {},
“lags”: {},</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
</section>
<section id="id44">
<h3>}<a class="headerlink" href="#id44" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl>
<dt><a href="#id45"><span class="problematic" id="id46">**</span></a>fit_kwargs: Other key word arguments to pass to fit() function of</dt><dd><p>the searched learners, such as sample_weight. Below are a few examples of
estimator-specific parameters:</p>
<blockquote>
<div><p>period: int | forecast horizon for all time series forecast tasks.
gpu_per_trial: float, default = 0 | A float of the number of gpus per trial,</p>
<blockquote>
<div><p>only used by TransformersEstimator, XGBoostSklearnEstimator, and
TemporalFusionTransformerEstimator.</p>
</div></blockquote>
<dl class="simple">
<dt>group_ids: list of strings of column names identifying a time series, only</dt><dd><p>used by TemporalFusionTransformerEstimator, required for
‘ts_forecast_panel’ task. <cite>group_ids</cite> is a parameter for TimeSeriesDataSet object
from PyTorchForecasting.
For other parameters to describe your dataset, refer to
[TimeSeriesDataSet PyTorchForecasting](<a class="reference external" href="https://pytorch-forecasting.readthedocs.io/en/stable/api/pytorch_forecasting.data.timeseries.TimeSeriesDataSet.html">https://pytorch-forecasting.readthedocs.io/en/stable/api/pytorch_forecasting.data.timeseries.TimeSeriesDataSet.html</a>).
To specify your variables, use <cite>static_categoricals</cite>, <cite>static_reals</cite>,
<cite>time_varying_known_categoricals</cite>, <cite>time_varying_known_reals</cite>,
<cite>time_varying_unknown_categoricals</cite>, <cite>time_varying_unknown_reals</cite>,
<cite>variable_groups</cite>. To provide more information on your data, use
<cite>max_encoder_length</cite>, <cite>min_encoder_length</cite>, <cite>lags</cite>.</p>
</dd>
<dt>log_dir: str, default = “lightning_logs” | Folder into which to log results</dt><dd><p>for tensorboard, only used by TemporalFusionTransformerEstimator.</p>
</dd>
<dt>max_epochs: int, default = 20 | Maximum number of epochs to run training,</dt><dd><p>only used by TemporalFusionTransformerEstimator.</p>
</dd>
<dt>batch_size: int, default = 64 | Batch size for training model, only</dt><dd><p>used by TemporalFusionTransformerEstimator.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.memoizer.fitter_fun">
<span class="sig-prename descclassname"><span class="pre">causaltune.memoizer.</span></span><span class="sig-name descname"><span class="pre">fitter_fun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/memoizer.html#fitter_fun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.fitter_fun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.memoizer.get_hash">
<span class="sig-prename descclassname"><span class="pre">causaltune.memoizer.</span></span><span class="sig-name descname"><span class="pre">get_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/memoizer.html#get_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.get_hash" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.memoizer.json_default">
<span class="sig-prename descclassname"><span class="pre">causaltune.memoizer.</span></span><span class="sig-name descname"><span class="pre">json_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/memoizer.html#json_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.json_default" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.memoizer.json_dumps">
<span class="sig-prename descclassname"><span class="pre">causaltune.memoizer.</span></span><span class="sig-name descname"><span class="pre">json_dumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/memoizer.html#json_dumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.memoizer.json_dumps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-causaltune.optimiser">
<span id="causaltune-optimiser-module"></span><h2>causaltune.optimiser module<a class="headerlink" href="#module-causaltune.optimiser" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.optimiser.</span></span><span class="sig-name descname"><span class="pre">CausalTune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy_distance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dummy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_pred_time_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_njobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_time_budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_init_configs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resources_per_trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_experimental_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_all_estimators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Performs AutoML to find best EconML estimator.
Optimises hyperparams of component models of each estimator
and hyperparams of the estimators themselves. Uses the ERUPT
metric for estimator selection.</p>
<p>Example:
<a href="#id47"><span class="problematic" id="id48">``</span></a><a href="#id49"><span class="problematic" id="id50">`</span></a>python</p>
<p>cd = CausalityDataset(data=df, treatment=’T’, outcomes=[‘Y’])
cd.preprocess_dataset()</p>
<p>estimator_list = [“.LinearDML”,”LinearDRLearner”,”metalearners”]
ct = CausalTune(time_budget=10, estimator_list=estimator_list)</p>
<p>ct.fit(cd)</p>
<p>print(f”Best estimator: {ct.best_estimator}”)</p>
<p><a href="#id51"><span class="problematic" id="id52">``</span></a><a href="#id53"><span class="problematic" id="id54">`</span></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_config</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_config" title="Permalink to this definition">¶</a></dt>
<dd><p>the best configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>&#64;return (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_config_per_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_config_per_estimator</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_config_per_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>all estimators’ best configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>&#64;return (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_estimator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>A string indicating the best estimator found</p>
<p>&#64;return: None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_model_for_estimator">
<span class="sig-name descname"><span class="pre">best_model_for_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.best_model_for_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_model_for_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the best model found for a particular estimator.
estimator: self.tune_results[estimator].best_config</p>
<p>&#64;param estimator_name (str): the estimator’s name.</p>
<p>&#64;return (dowhy.causal_estimator.CausalEstimate): the best model for estimator_name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_score">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_score" title="Permalink to this definition">¶</a></dt>
<dd><p>the best score found.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>&#64;return (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_score_per_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score_per_estimator</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_score_per_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of all estimators’ best score.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.effect">
<span class="sig-name descname"><span class="pre">effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Heterogeneous Treatment Effects for data df</p>
<p>&#64;param df (pd.DataFrame): data to predict treatment effect for
&#64;return (np.ndarray): predicted treatment effect for each datapoint</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.effect_inference">
<span class="sig-name descname"><span class="pre">effect_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.effect_inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference (uncertainty) results produced by best estimator
Only implemented for EconML estimators so far</p>
<p>&#64;param df (pd.DataFrame): data to run inference on
&#64;param args: passed through to underlying estimator
&#64;param kwargs: passed through to underlying estimator
&#64;return (from EconML: NormalInferenceResults):</p>
<blockquote>
<div><p>EconML results object for inference assuming a normal distribution.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.effect_stderr">
<span class="sig-name descname"><span class="pre">effect_stderr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect_stderr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.effect_stderr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute standard errors for best causal estimator</dt><dd><p>Currently implemented for EconML estimators.
Computes analytical standard errors if available and boostraps otherwise.</p>
</dd>
</dl>
<p>&#64;param df (pd.DataFrame): data to run inference on
&#64;param n_bootstrap_samples (int, optional): number of runs if standard errors are boostrapped. Defaults to 5.
&#64;param n_jobs (int, optional): Number of bootstrap estimates to run in parallel. Defaults to 1.
&#64;return (np.ndarray): standard error for each data point from df</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_causes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_budget</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs AutoML on list of causal inference estimators
- If estimator has a search space specified in its parameters, HPO is performed on the whole model.
- Otherwise, only its component models are optimised</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&#64;param</em>) – dataset for causal inference</p></li>
<li><p><strong>treatment</strong> (<em>&#64;param</em>) – name of treatment variable</p></li>
<li><p><strong>outcome</strong> (<em>&#64;param</em>) – name of outcome variable</p></li>
<li><p><strong>common_causes</strong> (<em>&#64;param</em>) – list of names of common causes</p></li>
<li><p><strong>effect_modifiers</strong> (<em>&#64;param</em>) – list of names of effect modifiers</p></li>
<li><p><strong>instruments</strong> (<em>&#64;param</em>) – list of names of instrumental variables</p></li>
<li><p><strong>propensity_modifiers</strong> (<em>&#64;param</em>) – list of names of propensity modifiers</p></li>
<li><p><strong>estimator_list</strong> (<em>&#64;param</em>) – subset of estimators to consider</p></li>
<li><p><strong>resume</strong> (<em>&#64;param</em>) – set to True to continue previous fit</p></li>
<li><p><strong>time_budget</strong> (<em>&#64;param</em>) – change new time budget allocated to fit, useful for warm starts.</p></li>
<li><p><strong>&#64;return</strong> – None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.get_estimators">
<span class="sig-name descname"><span class="pre">get_estimators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.get_estimators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.get_estimators" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.get_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.init_outcome_model">
<span class="sig-name descname"><span class="pre">init_outcome_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.init_outcome_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.init_outcome_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.init_propensity_model">
<span class="sig-name descname"><span class="pre">init_propensity_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.init_propensity_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.init_propensity_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <em>trained</em> best estimator</p>
<p>&#64;return CausalEstimator</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.score_dataset">
<span class="sig-name descname"><span class="pre">score_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.score_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.score_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>After fitting, generate scores for an additional dataset, add them to the scores dict.</p>
<p>&#64;param df (pandas.DataFrame): input dataframe
&#64;param dataset_name (str): dictionary key</p>
<p>&#64;return: None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.update_summary_scores">
<span class="sig-name descname"><span class="pre">update_summary_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.update_summary_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.update_summary_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores scores for metric of interest for each estimator</p>
<p>&#64;return: None</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-causaltune.params">
<span id="causaltune-params-module"></span><h2>causaltune.params module<a class="headerlink" href="#module-causaltune.params" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.params.</span></span><span class="sig-name descname"><span class="pre">EstimatorConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_params:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_params:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_space:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defaults:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supports_multivalue:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experimental:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'bootstrap'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/params.html#EstimatorConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.params.EstimatorConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.defaults">
<span class="sig-name descname"><span class="pre">defaults</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.defaults" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.experimental">
<span class="sig-name descname"><span class="pre">experimental</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.experimental" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.fit_params">
<span class="sig-name descname"><span class="pre">fit_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.fit_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bootstrap'</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.inference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.init_params">
<span class="sig-name descname"><span class="pre">init_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.init_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.search_space">
<span class="sig-name descname"><span class="pre">search_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.search_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.params.EstimatorConfig.supports_multivalue">
<span class="sig-name descname"><span class="pre">supports_multivalue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#causaltune.params.EstimatorConfig.supports_multivalue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="causaltune.params.SimpleParamService">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.params.</span></span><span class="sig-name descname"><span class="pre">SimpleParamService</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multivalue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_experimental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/params.html#SimpleParamService"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.params.SimpleParamService" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.params.SimpleParamService.default_configs">
<span class="sig-name descname"><span class="pre">default_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/params.html#SimpleParamService.default_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.params.SimpleParamService.default_configs" title="Permalink to this definition">¶</a></dt>
<dd><p>creates list with initial configs to try before moving
on to hierarchical HPO.
The list has been identified by evaluating performance of all
learners on a range of datasets (and metrics).
Each entry is a dictionary with a learner and its best-performing
hyper params
TODO: identify best_performers for list below
:returns: list of dicts with promising initial configs
:rtype: list</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.params.SimpleParamService.estimator_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimator_names</span></span><a class="headerlink" href="#causaltune.params.SimpleParamService.estimator_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.params.SimpleParamService.estimator_names_from_patterns">
<span class="sig-name descname"><span class="pre">estimator_names_from_patterns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/params.html#SimpleParamService.estimator_names_from_patterns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.params.SimpleParamService.estimator_names_from_patterns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.params.SimpleParamService.method_params">
<span class="sig-name descname"><span class="pre">method_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/params.html#SimpleParamService.method_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.params.SimpleParamService.method_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.params.SimpleParamService.search_space">
<span class="sig-name descname"><span class="pre">search_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/params.html#SimpleParamService.search_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.params.SimpleParamService.search_space" title="Permalink to this definition">¶</a></dt>
<dd><p>constructs search space with estimators and their respective configs</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>hierarchical search space</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-causaltune.r_score">
<span id="causaltune-r-score-module"></span><h2>causaltune.r_score module<a class="headerlink" href="#module-causaltune.r_score" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.r_score.RScoreWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.r_score.</span></span><span class="sig-name descname"><span class="pre">RScoreWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_causes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_modifiers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/r_score.html#RScoreWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.r_score.RScoreWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="causaltune.r_score.RScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.r_score.</span></span><span class="sig-name descname"><span class="pre">RScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discrete_treatment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categories</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/r_score.html#RScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.r_score.RScorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Scorer based on the RLearner loss. Fits residual models at fit time and calculates
residuals of the evaluation data in a cross-fitting manner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Yres</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="n">Y</span><span class="o">|</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">]</span>
<span class="n">Tres</span> <span class="o">=</span> <span class="n">T</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="n">T</span><span class="o">|</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">]</span>
</pre></div>
</div>
<p>Then for any given cate model calculates the loss:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span><span class="p">(</span><span class="n">cate</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_n</span><span class="p">[(</span><span class="n">Yres</span> <span class="o">-</span> <span class="o">&lt;</span><span class="n">cate</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">Tres</span><span class="o">&gt;</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Also calculates a baseline loss based on a constant treatment effect model, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base_loss</span> <span class="o">=</span> <span class="n">min_</span><span class="p">{</span><span class="n">theta</span><span class="p">}</span> <span class="n">E_n</span><span class="p">[(</span><span class="n">Yres</span> <span class="o">-</span> <span class="o">&lt;</span><span class="n">theta</span><span class="p">,</span> <span class="n">Tres</span><span class="o">&gt;</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Returns an analogue of the R-square score for regression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">score</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">loss</span><span class="p">(</span><span class="n">cate</span><span class="p">)</span> <span class="o">/</span> <span class="n">base_loss</span>
</pre></div>
</div>
<p>This corresponds to the extra variance of the outcome explained by introducing heterogeneity
in the effect as captured by the cate model, as opposed to always predicting a constant effect.
A negative score, means that the cate model performs even worse than a constant effect model
and hints at overfitting during training of the cate model.</p>
<p>This method was also advocated in recent work of <a class="reference internal" href="#schuleretal2018" id="id55"><span>[Schuleretal2018]</span></a> when compared among several alternatives
for causal model selection and introduced in the work of <a class="reference internal" href="#niewager2017" id="id56"><span>[NieWager2017]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_y</strong> (<em>estimator</em>) – The estimator for fitting the response to the features. Must implement
<cite>fit</cite> and <cite>predict</cite> methods.</p></li>
<li><p><strong>model_t</strong> (<em>estimator</em>) – The estimator for fitting the treatment to the features. Must implement
<cite>fit</cite> and <cite>predict</cite> methods.</p></li>
<li><p><strong>discrete_treatment</strong> (bool, optional (default is <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – Whether the treatment values should be treated as categorical, rather than continuous, quantities</p></li>
<li><p><strong>categories</strong> (<em>'auto'</em><em> or </em><em>list</em><em>, </em><em>default 'auto'</em>) – The categories to use when encoding discrete treatments (or ‘auto’ to use the unique sorted values).
The first category will be treated as the control treatment.</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>cross-validation generator</em><em> or </em><em>an iterable</em><em>, </em><em>optional</em><em> (</em><em>Default=2</em><em>)</em>) – <p>Determines the cross-validation splitting strategy.
Possible inputs for cv are:</p>
<ul>
<li><p>None, to use the default 3-fold cross-validation,</p></li>
<li><p>integer, to specify the number of folds.</p></li>
<li><p><span class="xref std std-term">CV splitter</span></p></li>
<li><p>An iterable yielding (train, test) splits as arrays of indices.</p></li>
</ul>
<p>For integer/None inputs, if the treatment is discrete
<code class="xref py py-class docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> is used, else,
<code class="xref py py-class docutils literal notranslate"><span class="pre">KFold</span></code> is used
(with a random shuffle in either case).</p>
<p>Unless an iterable is used, we call <cite>split(concat[W, X], T)</cite> to generate the splits. If all
W, X are None, then we call <cite>split(ones((T.shape[0], 1)), T)</cite>.</p>
</p></li>
<li><p><strong>mc_iters</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default=None</em><em>)</em>) – The number of times to rerun the first stage models to reduce the variance of the nuisances.</p></li>
<li><p><strong>mc_agg</strong> (<em>{'mean'</em><em>, </em><em>'median'}</em><em>, </em><em>optional</em><em> (</em><em>default='mean'</em><em>)</em>) – How to aggregate the nuisance value for each sample across the <cite>mc_iters</cite> monte carlo iterations of
cross-fitting.</p></li>
<li><p><strong>random_state</strong> (int, <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code> instance or None, optional (default=None)) – If int, random_state is the seed used by the random number generator;
If <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code> instance, random_state is the random number generator;
If None, the random number generator is the <code class="xref py py-class docutils literal notranslate"><span class="pre">RandomState</span></code> instance used
by <code class="xref py py-mod docutils literal notranslate"><span class="pre">np.random</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="niewager2017" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id56">NieWager2017</a><span class="fn-bracket">]</span></span>
<p>X. Nie and S. Wager.
Quasi-Oracle Estimation of Heterogeneous Treatment Effects.
arXiv preprint arXiv:1712.04912, 2017.
<a class="reference external" href="https://arxiv.org/pdf/1712.04912.pdf">https://arxiv.org/pdf/1712.04912.pdf</a></p>
</div>
<div class="citation" id="schuleretal2018" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id55">Schuleretal2018</a><span class="fn-bracket">]</span></span>
<p>Alejandro Schuler, Michael Baiocchi, Robert Tibshirani, Nigam Shah.
“A comparison of methods for model selection when estimating individual treatment effects.”
Arxiv, 2018
<a class="reference external" href="https://arxiv.org/pdf/1804.05146.pdf">https://arxiv.org/pdf/1804.05146.pdf</a></p>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.r_score.RScorer.best_model">
<span class="sig-name descname"><span class="pre">best_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/r_score.html#RScorer.best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.r_score.RScorer.best_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Chooses the best among a list of models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cate_models</strong> (<em>list</em><em> of </em><em>instances</em><em> of </em><em>fitted BaseCateEstimator</em>) – </p></li>
<li><p><strong>return_scores</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default=False</em><em>)</em>) – Whether to return the list scores of each model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>best_model</strong> (<em>instance of fitted BaseCateEstimator</em>) – The model that achieves the best score</p></li>
<li><p><strong>best_score</strong> (<em>double</em>) – The score of the best model</p></li>
<li><p><strong>scores</strong> (<em>list of double</em>) – The list of scores for each of the input models. Returned only if <cite>return_scores=True</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.r_score.RScorer.ensemble">
<span class="sig-name descname"><span class="pre">ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/r_score.html#RScorer.ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.r_score.RScorer.ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensembles a list of models based on their performance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cate_models</strong> (<em>list</em><em> of </em><em>instances</em><em> of </em><em>fitted BaseCateEstimator</em>) – </p></li>
<li><p><strong>eta</strong> (<em>double</em><em>, </em><em>optional</em><em> (</em><em>default=1000</em><em>)</em>) – The soft-max parameter for the ensemble</p></li>
<li><p><strong>return_scores</strong> (<em>bool</em><em>, </em><em>optional</em><em> (</em><em>default=False</em><em>)</em>) – Whether to return the list scores of each model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ensemble_model</strong> (<em>instance of fitted EnsembleCateEstimator</em>) – A fitted ensemble cate model that calculates effects based on a weighted
version of the input cate models, weighted by a softmax of their score
performance</p></li>
<li><p><strong>ensemble_score</strong> (<em>double</em>) – The score of the ensemble model</p></li>
<li><p><strong>scores</strong> (<em>list of double</em>) – The list of scores for each of the input models. Returned only if <cite>return_scores=True</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.r_score.RScorer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/r_score.html#RScorer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.r_score.RScorer.fit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Y</strong> (<em>(</em><em>n x d_y</em><em>) </em><em>matrix</em><em> or </em><em>vector</em><em> of </em><em>length n</em>) – Outcomes for each sample</p></li>
<li><p><strong>T</strong> (<em>(</em><em>n x dₜ</em><em>) </em><em>matrix</em><em> or </em><em>vector</em><em> of </em><em>length n</em>) – Treatments for each sample</p></li>
<li><p><strong>X</strong> (<em>optional</em><em> (</em><em>n x dₓ</em><em>) </em><em>matrix</em>) – Features for each sample</p></li>
<li><p><strong>W</strong> (<em>optional</em><em> (</em><em>n x d_w</em><em>) </em><em>matrix</em>) – Controls for each sample</p></li>
<li><p><strong>sample_weight</strong> (<em>optional</em><em> (</em><em>n</em><em>,</em><em>) </em><em>vector</em>) – Weights for each row</p></li>
<li><p><strong>groups</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>vector</em><em>, </em><em>optional</em>) – All rows corresponding to the same group will be kept together during splitting.
If groups is not None, the <cite>cv</cite> argument passed to this class’s initializer
must support a ‘groups’ argument to its split method.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.r_score.RScorer.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/r_score.html#RScorer.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.r_score.RScorer.score" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cate_model</strong> (<em>instance</em><em> of </em><em>fitted BaseCateEstimator</em>) – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – An analogue of the R-square loss for the causal setting.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-causaltune.scoring">
<span id="causaltune-scoring-module"></span><h2>causaltune.scoring module<a class="headerlink" href="#module-causaltune.scoring" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.scoring.DummyEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.scoring.</span></span><span class="sig-name descname"><span class="pre">DummyEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#DummyEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.DummyEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.DummyEstimator.const_marginal_effect">
<span class="sig-name descname"><span class="pre">const_marginal_effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#DummyEstimator.const_marginal_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.DummyEstimator.const_marginal_effect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.scoring.</span></span><span class="sig-name descname"><span class="pre">Scorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multivalue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.ate">
<span class="sig-name descname"><span class="pre">ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.ate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Average Treatment Effect. Provide naive std estimates in single-treatment cases.</p>
<p>&#64;param df (pandas.DataFrame): input dataframe</p>
<dl class="simple">
<dt>&#64;return tuple: tuple containing the ATE, standard deviation of the estimate (or None if multi-treatment),</dt><dd><p>and sample size (or None if estimate has more than one dimension)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.auc_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auc_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.auc_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.auc_make_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the area under the uplift curve.</p>
<p>&#64;param estimate (dowhy.causal_estimator.CausalEstimate): causal estimate to evaluate
&#64;param df (pandas.DataFrame): input dataframe
&#64;param cate_estimate (np.ndarray): array with cate estimates</p>
<p>&#64;return float: area under the uplift curve</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.best_score_by_estimator">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score_by_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.best_score_by_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.best_score_by_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain best score for each estimator.</p>
<p>&#64;param scores (Dict[str, dict]): CausalTune.scores dictionary
&#64;param metric (str): metric of interest</p>
<p>&#64;return Dict[str, dict]: dictionary containing best score by estimator</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.energy_distance_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_distance_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.energy_distance_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.energy_distance_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate energy distance score between treated and controls.</p>
<p>For theoretical details, see Ramos-Carreño and Torrecilla (2023).</p>
<p>&#64;param estimate (dowhy.causal_estimator.CausalEstimate): causal estimate to evaluate
&#64;param df (pandas.DataFrame): input dataframe</p>
<p>&#64;return float: energy distance score</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.group_ate">
<span class="sig-name descname"><span class="pre">group_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.group_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.group_ate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average treatment effect (ATE) for different groups specified by a policy.</p>
<p>&#64;param df (pandas.DataFrame): input dataframe, should contain columns for the treatment, outcome, and policy
&#64;param policy (Union[pd.DataFrame, np.ndarray]): policy column in df or an array of the policy values,</p>
<blockquote>
<div><p>used to group the data</p>
</div></blockquote>
<p>&#64;return: pandas.DataFrame of ATE, std, and size per policy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.make_scores">
<span class="sig-name descname"><span class="pre">make_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_scorer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.make_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.make_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate various performance metrics for a given causal estimate using a given DataFrame.</p>
<p>&#64;param estimate (dowhy.causal_estimator.CausalEstimate): causal estimate to evaluate
&#64;param df (pandas.DataFrame): input dataframe
&#64;param metrics_to_report (List[str]): list of strings specifying the evaluation metrics to compute.</p>
<blockquote>
<div><p>Possible options include ‘ate’, ‘erupt’, ‘norm_erupt’, ‘qini’, ‘auc’, and ‘energy_distance’.</p>
</div></blockquote>
<p>&#64;param r_scorer (Optional): callable object used to compute the R-score, default is None</p>
<dl class="simple">
<dt>&#64;return dict: dictionary containing the evaluation metrics specified in metrics_to_report.</dt><dd><p>The values key in the dictionary contains the input DataFrame with additional columns for
the propensity scores, the policy, the normalized policy, and the weights, if applicable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.naive_ate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naive_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.naive_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.naive_ate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate simple ATE.</p>
<p>&#64;param treatment (pandas.Series): series of treatments
&#64;param outcome (pandas.Series): series of outcomes</p>
<p>&#64;return: tuple of simple ATE, standard deviation, and sample size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.qini_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qini_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.qini_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.qini_make_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Qini score, defined as the area between the Qini curves of a model and random.</p>
<p>&#64;param estimate (dowhy.causal_estimator.CausalEstimate): causal estimate to evaluate
&#64;param df (pandas.DataFrame): input dataframe
&#64;param cate_estimate (np.ndarray): array with cate estimates</p>
<p>&#64;return float: Qini score</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.r_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_scorer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.r_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.r_make_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate r_score.</p>
<p>For details refer to Nie and Wager (2017) and Schuler et al. (2018).</p>
<p>Adaption from EconML implementation.</p>
<p>&#64;param estimate (dowhy.causal_estimator.CausalEstimate): causal estimate to evaluate
&#64;param df (pandas.DataFrame): input dataframe
&#64;param cate_estimate (np.ndarray): array with cate estimates
&#64;param r_scorer: callable object used to compute the R-score</p>
<p>&#64;return float: r_score</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.real_qini_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">real_qini_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.real_qini_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.real_qini_make_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.resolve_metric">
<span class="sig-name descname"><span class="pre">resolve_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.resolve_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.resolve_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if supplied metric is supported. If not, default to ‘energy_distance’.</p>
<p>&#64;param metric (str): evaluation metric</p>
<p>&#64;return str: metric/’energy_distance’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.resolve_reported_metrics">
<span class="sig-name descname"><span class="pre">resolve_reported_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.resolve_reported_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.resolve_reported_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if supplied reporting metrics are valid.</p>
<dl class="simple">
<dt>&#64;param metrics_to_report (Union[List[str], None]): list of strings specifying the evaluation metrics to compute.</dt><dd><p>Possible options include ‘ate’, ‘erupt’, ‘norm_erupt’, ‘qini’, ‘auc’, and ‘energy_distance’.</p>
</dd>
</dl>
<p>&#64;param scoring_metric (str): specified metric</p>
<p>&#64;return List[str]: list of valid metrics</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.scoring.supported_metrics">
<span class="sig-prename descclassname"><span class="pre">causaltune.scoring.</span></span><span class="sig-name descname"><span class="pre">supported_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multivalue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#supported_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.supported_metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-causaltune.shap">
<span id="causaltune-shap-module"></span><h2>causaltune.shap module<a class="headerlink" href="#module-causaltune.shap" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="causaltune.shap.shap_values">
<span class="sig-prename descclassname"><span class="pre">causaltune.shap.</span></span><span class="sig-name descname"><span class="pre">shap_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/shap.html#shap_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.shap.shap_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.shap.shap_with_automl">
<span class="sig-prename descclassname"><span class="pre">causaltune.shap.</span></span><span class="sig-name descname"><span class="pre">shap_with_automl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nice_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/shap.html#shap_with_automl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.shap.shap_with_automl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-causaltune.utils">
<span id="causaltune-utils-module"></span><h2>causaltune.utils module<a class="headerlink" href="#module-causaltune.utils" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="causaltune.utils.clean_config">
<span class="sig-prename descclassname"><span class="pre">causaltune.utils.</span></span><span class="sig-name descname"><span class="pre">clean_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/utils.html#clean_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.utils.clean_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.utils.generate_psdmat">
<span class="sig-prename descclassname"><span class="pre">causaltune.utils.</span></span><span class="sig-name descname"><span class="pre">generate_psdmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/causaltune/utils.html#generate_psdmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.utils.generate_psdmat" title="Permalink to this definition">¶</a></dt>
<dd><p>generates a symmetric, positive semidefinite matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_dims</strong> (<em>int</em><em>, </em><em>optional</em>) – number of dimensions. Defaults to 10.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>psd matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.utils.policy_from_estimator">
<span class="sig-prename descclassname"><span class="pre">causaltune.utils.</span></span><span class="sig-name descname"><span class="pre">policy_from_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">est</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/utils.html#policy_from_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.utils.policy_from_estimator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.utils.treatment_is_multivalue">
<span class="sig-prename descclassname"><span class="pre">causaltune.utils.</span></span><span class="sig-name descname"><span class="pre">treatment_is_multivalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/causaltune/utils.html#treatment_is_multivalue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.utils.treatment_is_multivalue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.utils.treatment_values">
<span class="sig-prename descclassname"><span class="pre">causaltune.utils.</span></span><span class="sig-name descname"><span class="pre">treatment_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/utils.html#treatment_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.utils.treatment_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-causaltune.visualizer">
<span id="causaltune-visualizer-module"></span><h2>causaltune.visualizer module<a class="headerlink" href="#module-causaltune.visualizer" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.visualizer.</span></span><span class="sig-name descname"><span class="pre">Visualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment_col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer.plot_group_ate">
<span class="sig-name descname"><span class="pre">plot_group_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#causaltune.scoring.Scorer" title="causaltune.scoring.Scorer"><span class="pre">Scorer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer.plot_group_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer.plot_group_ate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Plot out-of sample difference of outcomes between treated and untreated</dt><dd><p>for the points where model predicts positive vs negative impact.</p>
</dd>
</dl>
<p>&#64;param scorer (CausalTune.scorer): scorer from CausalTune
&#64;param scores_dict (Dict): scores dict from fitted CausalTune object
&#64;param estimator (str): name of estimator to use</p>
<p>&#64;return pandas.DataFrame: dataframe of policy groups and average effect</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer.plot_metrics_by_estimator">
<span class="sig-name descname"><span class="pre">plot_metrics_by_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('norm_erupt',</span> <span class="pre">'ate')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer.plot_metrics_by_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer.plot_metrics_by_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot metrics by estimator.</p>
<p>&#64;param scores_dict (Dict): scores dict from fitted CausalTune object
&#64;param figtitle (str): specifying plot title, defaults to “”
&#64;param metrics (Tuple[str, str]): specifying metrics, defaults to (‘norm_erupt’, ‘ate’)
&#64;param figsize (Tuple[int, int]): specifying plot size, defaults to (7,5)</p>
<p>&#64;return: None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer.plot_shap">
<span class="sig-name descname"><span class="pre">plot_shap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer.plot_shap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer.plot_shap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Shapley values for given estimator.</p>
<p>&#64;param estimate (CausalEstimate): dowhy causal estimate
&#64;param df (pandas.DataFrame): dataframe for shapley calculation
&#64;param shaps (np.ndarray): pre-computed shapley values, if None, compute shapley values. Defaults to None.
&#64;param figtitle (str): plot title</p>
<p>&#64;return: None</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-causaltune">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-causaltune" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.CausalTune">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.</span></span><span class="sig-name descname"><span class="pre">CausalTune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy_distance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dummy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_pred_time_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_njobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_time_budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_init_configs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resources_per_trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_experimental_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_all_estimators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Performs AutoML to find best EconML estimator.
Optimises hyperparams of component models of each estimator
and hyperparams of the estimators themselves. Uses the ERUPT
metric for estimator selection.</p>
<p>Example:
<a href="#id57"><span class="problematic" id="id58">``</span></a><a href="#id59"><span class="problematic" id="id60">`</span></a>python</p>
<p>cd = CausalityDataset(data=df, treatment=’T’, outcomes=[‘Y’])
cd.preprocess_dataset()</p>
<p>estimator_list = [“.LinearDML”,”LinearDRLearner”,”metalearners”]
ct = CausalTune(time_budget=10, estimator_list=estimator_list)</p>
<p>ct.fit(cd)</p>
<p>print(f”Best estimator: {ct.best_estimator}”)</p>
<p><a href="#id61"><span class="problematic" id="id62">``</span></a><a href="#id63"><span class="problematic" id="id64">`</span></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="causaltune.CausalTune.best_config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_config</span></span><a class="headerlink" href="#causaltune.CausalTune.best_config" title="Permalink to this definition">¶</a></dt>
<dd><p>the best configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>&#64;return (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.CausalTune.best_config_per_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_config_per_estimator</span></span><a class="headerlink" href="#causaltune.CausalTune.best_config_per_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>all estimators’ best configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>&#64;return (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.CausalTune.best_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_estimator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#causaltune.CausalTune.best_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>A string indicating the best estimator found</p>
<p>&#64;return: None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.best_model_for_estimator">
<span class="sig-name descname"><span class="pre">best_model_for_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.best_model_for_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.best_model_for_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the best model found for a particular estimator.
estimator: self.tune_results[estimator].best_config</p>
<p>&#64;param estimator_name (str): the estimator’s name.</p>
<p>&#64;return (dowhy.causal_estimator.CausalEstimate): the best model for estimator_name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.CausalTune.best_score">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score</span></span><a class="headerlink" href="#causaltune.CausalTune.best_score" title="Permalink to this definition">¶</a></dt>
<dd><p>the best score found.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>&#64;return (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.CausalTune.best_score_per_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score_per_estimator</span></span><a class="headerlink" href="#causaltune.CausalTune.best_score_per_estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of all estimators’ best score.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.effect">
<span class="sig-name descname"><span class="pre">effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Heterogeneous Treatment Effects for data df</p>
<p>&#64;param df (pd.DataFrame): data to predict treatment effect for
&#64;return (np.ndarray): predicted treatment effect for each datapoint</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.effect_inference">
<span class="sig-name descname"><span class="pre">effect_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.effect_inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference (uncertainty) results produced by best estimator
Only implemented for EconML estimators so far</p>
<p>&#64;param df (pd.DataFrame): data to run inference on
&#64;param args: passed through to underlying estimator
&#64;param kwargs: passed through to underlying estimator
&#64;return (from EconML: NormalInferenceResults):</p>
<blockquote>
<div><p>EconML results object for inference assuming a normal distribution.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.effect_stderr">
<span class="sig-name descname"><span class="pre">effect_stderr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect_stderr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.effect_stderr" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute standard errors for best causal estimator</dt><dd><p>Currently implemented for EconML estimators.
Computes analytical standard errors if available and boostraps otherwise.</p>
</dd>
</dl>
<p>&#64;param df (pd.DataFrame): data to run inference on
&#64;param n_bootstrap_samples (int, optional): number of runs if standard errors are boostrapped. Defaults to 5.
&#64;param n_jobs (int, optional): Number of bootstrap estimates to run in parallel. Defaults to 1.
&#64;return (np.ndarray): standard error for each data point from df</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">CausalityDataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_causes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_budget</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs AutoML on list of causal inference estimators
- If estimator has a search space specified in its parameters, HPO is performed on the whole model.
- Otherwise, only its component models are optimised</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&#64;param</em>) – dataset for causal inference</p></li>
<li><p><strong>treatment</strong> (<em>&#64;param</em>) – name of treatment variable</p></li>
<li><p><strong>outcome</strong> (<em>&#64;param</em>) – name of outcome variable</p></li>
<li><p><strong>common_causes</strong> (<em>&#64;param</em>) – list of names of common causes</p></li>
<li><p><strong>effect_modifiers</strong> (<em>&#64;param</em>) – list of names of effect modifiers</p></li>
<li><p><strong>instruments</strong> (<em>&#64;param</em>) – list of names of instrumental variables</p></li>
<li><p><strong>propensity_modifiers</strong> (<em>&#64;param</em>) – list of names of propensity modifiers</p></li>
<li><p><strong>estimator_list</strong> (<em>&#64;param</em>) – subset of estimators to consider</p></li>
<li><p><strong>resume</strong> (<em>&#64;param</em>) – set to True to continue previous fit</p></li>
<li><p><strong>time_budget</strong> (<em>&#64;param</em>) – change new time budget allocated to fit, useful for warm starts.</p></li>
<li><p><strong>&#64;return</strong> – None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.get_estimators">
<span class="sig-name descname"><span class="pre">get_estimators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.get_estimators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.get_estimators" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.get_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.init_outcome_model">
<span class="sig-name descname"><span class="pre">init_outcome_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.init_outcome_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.init_outcome_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.init_propensity_model">
<span class="sig-name descname"><span class="pre">init_propensity_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.init_propensity_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.init_propensity_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.CausalTune.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#causaltune.CausalTune.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <em>trained</em> best estimator</p>
<p>&#64;return CausalEstimator</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.score_dataset">
<span class="sig-name descname"><span class="pre">score_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.score_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.score_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>After fitting, generate scores for an additional dataset, add them to the scores dict.</p>
<p>&#64;param df (pandas.DataFrame): input dataframe
&#64;param dataset_name (str): dictionary key</p>
<p>&#64;return: None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.CausalTune.update_summary_scores">
<span class="sig-name descname"><span class="pre">update_summary_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.update_summary_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.CausalTune.update_summary_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores scores for metric of interest for each estimator</p>
<p>&#64;return: None</p>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">causaltune package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-causaltune.data_utils">causaltune.data_utils module</a><ul>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset"><code class="docutils literal notranslate"><span class="pre">CausalityDataset</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.common_causes"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.common_causes</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.data"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.data</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.effect_modifiers"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.effect_modifiers</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.instruments"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.instruments</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.outcomes"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.outcomes</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.preprocess_dataset"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.preprocess_dataset()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.propensity_modifiers"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.propensity_modifiers</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.treatment"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.treatment</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.CausalityDataset.treatment_values"><code class="docutils literal notranslate"><span class="pre">CausalityDataset.treatment_values</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#causaltune.data_utils.featurize"><code class="docutils literal notranslate"><span class="pre">featurize()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.frequent_values"><code class="docutils literal notranslate"><span class="pre">frequent_values()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.data_utils.otherize_tail"><code class="docutils literal notranslate"><span class="pre">otherize_tail()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.datasets">causaltune.datasets module</a><ul>
<li><a class="reference internal" href="#causaltune.datasets.amazon_reviews"><code class="docutils literal notranslate"><span class="pre">amazon_reviews()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.generate_non_random_dataset"><code class="docutils literal notranslate"><span class="pre">generate_non_random_dataset()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.generate_synth_data_with_categories"><code class="docutils literal notranslate"><span class="pre">generate_synth_data_with_categories()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.generate_synthetic_data"><code class="docutils literal notranslate"><span class="pre">generate_synthetic_data()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.iv_dgp_econml"><code class="docutils literal notranslate"><span class="pre">iv_dgp_econml()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.lalonde_nsw"><code class="docutils literal notranslate"><span class="pre">lalonde_nsw()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.linear_multi_dataset"><code class="docutils literal notranslate"><span class="pre">linear_multi_dataset()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.mlrate_experiment_synth_dgp"><code class="docutils literal notranslate"><span class="pre">mlrate_experiment_synth_dgp()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.nhefs"><code class="docutils literal notranslate"><span class="pre">nhefs()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.synth_acic"><code class="docutils literal notranslate"><span class="pre">synth_acic()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.datasets.synth_ihdp"><code class="docutils literal notranslate"><span class="pre">synth_ihdp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.erupt">causaltune.erupt module</a><ul>
<li><a class="reference internal" href="#causaltune.erupt.DummyPropensity"><code class="docutils literal notranslate"><span class="pre">DummyPropensity</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.erupt.DummyPropensity.fit"><code class="docutils literal notranslate"><span class="pre">DummyPropensity.fit()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.erupt.DummyPropensity.predict_proba"><code class="docutils literal notranslate"><span class="pre">DummyPropensity.predict_proba()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#causaltune.erupt.ERUPT"><code class="docutils literal notranslate"><span class="pre">ERUPT</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.erupt.ERUPT.fit"><code class="docutils literal notranslate"><span class="pre">ERUPT.fit()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.erupt.ERUPT.score"><code class="docutils literal notranslate"><span class="pre">ERUPT.score()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.erupt.ERUPT.weights"><code class="docutils literal notranslate"><span class="pre">ERUPT.weights()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.memoizer">causaltune.memoizer module</a><ul>
<li><a class="reference internal" href="#causaltune.memoizer.Memoizer"><code class="docutils literal notranslate"><span class="pre">Memoizer</span></code></a></li>
<li><a class="reference internal" href="#causaltune.memoizer.MemoizingWrapper"><code class="docutils literal notranslate"><span class="pre">MemoizingWrapper</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.memoizer.MemoizingWrapper.fit"><code class="docutils literal notranslate"><span class="pre">MemoizingWrapper.fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#causaltune.memoizer.fitter_fun"><code class="docutils literal notranslate"><span class="pre">fitter_fun()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.memoizer.get_hash"><code class="docutils literal notranslate"><span class="pre">get_hash()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.memoizer.json_default"><code class="docutils literal notranslate"><span class="pre">json_default()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.memoizer.json_dumps"><code class="docutils literal notranslate"><span class="pre">json_dumps()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.optimiser">causaltune.optimiser module</a><ul>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune"><code class="docutils literal notranslate"><span class="pre">CausalTune</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.best_config"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_config</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.best_config_per_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_config_per_estimator</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.best_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_estimator</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.best_model_for_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_model_for_estimator()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.best_score"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_score</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.best_score_per_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_score_per_estimator</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.effect"><code class="docutils literal notranslate"><span class="pre">CausalTune.effect()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.effect_inference"><code class="docutils literal notranslate"><span class="pre">CausalTune.effect_inference()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.effect_stderr"><code class="docutils literal notranslate"><span class="pre">CausalTune.effect_stderr()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.fit"><code class="docutils literal notranslate"><span class="pre">CausalTune.fit()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.get_estimators"><code class="docutils literal notranslate"><span class="pre">CausalTune.get_estimators()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.get_params"><code class="docutils literal notranslate"><span class="pre">CausalTune.get_params()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.init_outcome_model"><code class="docutils literal notranslate"><span class="pre">CausalTune.init_outcome_model()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.init_propensity_model"><code class="docutils literal notranslate"><span class="pre">CausalTune.init_propensity_model()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.model"><code class="docutils literal notranslate"><span class="pre">CausalTune.model</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.score_dataset"><code class="docutils literal notranslate"><span class="pre">CausalTune.score_dataset()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.optimiser.CausalTune.update_summary_scores"><code class="docutils literal notranslate"><span class="pre">CausalTune.update_summary_scores()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.params">causaltune.params module</a><ul>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.defaults"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.defaults</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.experimental"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.experimental</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.fit_params"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.fit_params</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.inference"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.inference</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.init_params"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.init_params</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.search_space"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.search_space</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.EstimatorConfig.supports_multivalue"><code class="docutils literal notranslate"><span class="pre">EstimatorConfig.supports_multivalue</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#causaltune.params.SimpleParamService"><code class="docutils literal notranslate"><span class="pre">SimpleParamService</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.params.SimpleParamService.default_configs"><code class="docutils literal notranslate"><span class="pre">SimpleParamService.default_configs()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.SimpleParamService.estimator_names"><code class="docutils literal notranslate"><span class="pre">SimpleParamService.estimator_names</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.SimpleParamService.estimator_names_from_patterns"><code class="docutils literal notranslate"><span class="pre">SimpleParamService.estimator_names_from_patterns()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.SimpleParamService.method_params"><code class="docutils literal notranslate"><span class="pre">SimpleParamService.method_params()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.params.SimpleParamService.search_space"><code class="docutils literal notranslate"><span class="pre">SimpleParamService.search_space()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.r_score">causaltune.r_score module</a><ul>
<li><a class="reference internal" href="#causaltune.r_score.RScoreWrapper"><code class="docutils literal notranslate"><span class="pre">RScoreWrapper</span></code></a></li>
<li><a class="reference internal" href="#causaltune.r_score.RScorer"><code class="docutils literal notranslate"><span class="pre">RScorer</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.r_score.RScorer.best_model"><code class="docutils literal notranslate"><span class="pre">RScorer.best_model()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.r_score.RScorer.ensemble"><code class="docutils literal notranslate"><span class="pre">RScorer.ensemble()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.r_score.RScorer.fit"><code class="docutils literal notranslate"><span class="pre">RScorer.fit()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.r_score.RScorer.score"><code class="docutils literal notranslate"><span class="pre">RScorer.score()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.scoring">causaltune.scoring module</a><ul>
<li><a class="reference internal" href="#causaltune.scoring.DummyEstimator"><code class="docutils literal notranslate"><span class="pre">DummyEstimator</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.scoring.DummyEstimator.const_marginal_effect"><code class="docutils literal notranslate"><span class="pre">DummyEstimator.const_marginal_effect()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer"><code class="docutils literal notranslate"><span class="pre">Scorer</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.ate"><code class="docutils literal notranslate"><span class="pre">Scorer.ate()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.auc_make_score"><code class="docutils literal notranslate"><span class="pre">Scorer.auc_make_score()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.best_score_by_estimator"><code class="docutils literal notranslate"><span class="pre">Scorer.best_score_by_estimator()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.energy_distance_score"><code class="docutils literal notranslate"><span class="pre">Scorer.energy_distance_score()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.group_ate"><code class="docutils literal notranslate"><span class="pre">Scorer.group_ate()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.make_scores"><code class="docutils literal notranslate"><span class="pre">Scorer.make_scores()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.naive_ate"><code class="docutils literal notranslate"><span class="pre">Scorer.naive_ate()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.qini_make_score"><code class="docutils literal notranslate"><span class="pre">Scorer.qini_make_score()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.r_make_score"><code class="docutils literal notranslate"><span class="pre">Scorer.r_make_score()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.real_qini_make_score"><code class="docutils literal notranslate"><span class="pre">Scorer.real_qini_make_score()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.resolve_metric"><code class="docutils literal notranslate"><span class="pre">Scorer.resolve_metric()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.scoring.Scorer.resolve_reported_metrics"><code class="docutils literal notranslate"><span class="pre">Scorer.resolve_reported_metrics()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#causaltune.scoring.supported_metrics"><code class="docutils literal notranslate"><span class="pre">supported_metrics()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.shap">causaltune.shap module</a><ul>
<li><a class="reference internal" href="#causaltune.shap.shap_values"><code class="docutils literal notranslate"><span class="pre">shap_values()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.shap.shap_with_automl"><code class="docutils literal notranslate"><span class="pre">shap_with_automl()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.utils">causaltune.utils module</a><ul>
<li><a class="reference internal" href="#causaltune.utils.clean_config"><code class="docutils literal notranslate"><span class="pre">clean_config()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.utils.generate_psdmat"><code class="docutils literal notranslate"><span class="pre">generate_psdmat()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.utils.policy_from_estimator"><code class="docutils literal notranslate"><span class="pre">policy_from_estimator()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.utils.treatment_is_multivalue"><code class="docutils literal notranslate"><span class="pre">treatment_is_multivalue()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.utils.treatment_values"><code class="docutils literal notranslate"><span class="pre">treatment_values()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune.visualizer">causaltune.visualizer module</a><ul>
<li><a class="reference internal" href="#causaltune.visualizer.Visualizer"><code class="docutils literal notranslate"><span class="pre">Visualizer</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.visualizer.Visualizer.plot_group_ate"><code class="docutils literal notranslate"><span class="pre">Visualizer.plot_group_ate()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.visualizer.Visualizer.plot_metrics_by_estimator"><code class="docutils literal notranslate"><span class="pre">Visualizer.plot_metrics_by_estimator()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.visualizer.Visualizer.plot_shap"><code class="docutils literal notranslate"><span class="pre">Visualizer.plot_shap()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-causaltune">Module contents</a><ul>
<li><a class="reference internal" href="#causaltune.CausalTune"><code class="docutils literal notranslate"><span class="pre">CausalTune</span></code></a><ul>
<li><a class="reference internal" href="#causaltune.CausalTune.best_config"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_config</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.best_config_per_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_config_per_estimator</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.best_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_estimator</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.best_model_for_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_model_for_estimator()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.best_score"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_score</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.best_score_per_estimator"><code class="docutils literal notranslate"><span class="pre">CausalTune.best_score_per_estimator</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.effect"><code class="docutils literal notranslate"><span class="pre">CausalTune.effect()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.effect_inference"><code class="docutils literal notranslate"><span class="pre">CausalTune.effect_inference()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.effect_stderr"><code class="docutils literal notranslate"><span class="pre">CausalTune.effect_stderr()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.fit"><code class="docutils literal notranslate"><span class="pre">CausalTune.fit()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.get_estimators"><code class="docutils literal notranslate"><span class="pre">CausalTune.get_estimators()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.get_params"><code class="docutils literal notranslate"><span class="pre">CausalTune.get_params()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.init_outcome_model"><code class="docutils literal notranslate"><span class="pre">CausalTune.init_outcome_model()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.init_propensity_model"><code class="docutils literal notranslate"><span class="pre">CausalTune.init_propensity_model()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.model"><code class="docutils literal notranslate"><span class="pre">CausalTune.model</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.score_dataset"><code class="docutils literal notranslate"><span class="pre">CausalTune.score_dataset()</span></code></a></li>
<li><a class="reference internal" href="#causaltune.CausalTune.update_summary_scores"><code class="docutils literal notranslate"><span class="pre">CausalTune.update_summary_scores()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation index</a><ul>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/causaltune.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2023, Wise Payments Limited, PyWhy Contributors.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.
  </div>
  
  </body>
</html>